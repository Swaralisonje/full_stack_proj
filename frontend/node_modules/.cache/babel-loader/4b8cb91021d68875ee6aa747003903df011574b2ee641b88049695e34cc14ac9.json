{"ast":null,"code":"import{useEffect,useState}from\"react\";import{Container,Button,Typography,TextField,Stack,Pagination}from\"@mui/material\";import API from\"../services/api\";import UserTable from\"../components/UserTable\";import{useNavigate}from\"react-router-dom\";import Notification from\"../components/Notification\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ListUsers(){const[users,setUsers]=useState([]);const[page,setPage]=useState(1);const[total,setTotal]=useState(0);const[search,setSearch]=useState(\"\");const[notify,setNotify]=useState({open:false,msg:\"\",type:\"success\"});const navigate=useNavigate();const limit=5;const fetchUsers=async()=>{try{const res=await API.get(\"/?page=\".concat(page,\"&limit=\").concat(limit));setUsers(res.data.users);setTotal(Math.ceil(res.data.total/limit));}catch(_unused){setNotify({open:true,msg:\"Failed to load users\",type:\"error\"});}};useEffect(()=>{fetchUsers();},[page]);const handleDelete=async id=>{try{await API.delete(\"/\".concat(id));setNotify({open:true,msg:\"User deleted\",type:\"success\"});fetchUsers();}catch(_unused2){setNotify({open:true,msg:\"Delete failed\",type:\"error\"});}};const handleSearch=async()=>{if(!search)return fetchUsers();const res=await API.get(\"/search?query=\".concat(search));setUsers(res.data);};const handleExport=()=>{window.open(\"http://localhost:5000/api/users/export\",\"_blank\");};return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{mt:3},children:\"User Management\"}),/*#__PURE__*/_jsxs(Stack,{direction:{xs:\"column\",sm:\"row\"},spacing:2,sx:{mt:2},children:[/*#__PURE__*/_jsx(TextField,{label:\"Search\",value:search,onChange:e=>setSearch(e.target.value)}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleSearch,children:\"Search\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:handleExport,children:\"Export CSV\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:()=>navigate(\"/add\"),children:\"Add User\"})]}),/*#__PURE__*/_jsx(UserTable,{users:users,onDelete:handleDelete}),/*#__PURE__*/_jsx(Pagination,{count:total,page:page,onChange:(e,val)=>setPage(val),sx:{mt:3}}),/*#__PURE__*/_jsx(Notification,{notify:notify,setNotify:setNotify})]});}","map":{"version":3,"names":["useEffect","useState","Container","Button","Typography","TextField","Stack","Pagination","API","UserTable","useNavigate","Notification","jsx","_jsx","jsxs","_jsxs","ListUsers","users","setUsers","page","setPage","total","setTotal","search","setSearch","notify","setNotify","open","msg","type","navigate","limit","fetchUsers","res","get","concat","data","Math","ceil","_unused","handleDelete","id","delete","_unused2","handleSearch","handleExport","window","children","variant","sx","mt","direction","xs","sm","spacing","label","value","onChange","e","target","onClick","onDelete","count","val"],"sources":["C:/Users/Admin/PycharmProjects/full_stack_proj/frontend/src/pages/ListUsers.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport {\r\n  Container,\r\n  Button,\r\n  Typography,\r\n  TextField,\r\n  Stack,\r\n  Pagination\r\n} from \"@mui/material\";\r\nimport API from \"../services/api\";\r\nimport UserTable from \"../components/UserTable\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Notification from \"../components/Notification\";\r\n\r\nexport default function ListUsers() {\r\n  const [users, setUsers] = useState([]);\r\n  const [page, setPage] = useState(1);\r\n  const [total, setTotal] = useState(0);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [notify, setNotify] = useState({ open: false, msg: \"\", type: \"success\" });\r\n\r\n  const navigate = useNavigate();\r\n  const limit = 5;\r\n\r\n  const fetchUsers = async () => {\r\n    try {\r\n      const res = await API.get(`/?page=${page}&limit=${limit}`);\r\n      setUsers(res.data.users);\r\n      setTotal(Math.ceil(res.data.total / limit));\r\n    } catch {\r\n      setNotify({ open: true, msg: \"Failed to load users\", type: \"error\" });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n  }, [page]);\r\n\r\n  const handleDelete = async (id) => {\r\n    try {\r\n      await API.delete(`/${id}`);\r\n      setNotify({ open: true, msg: \"User deleted\", type: \"success\" });\r\n      fetchUsers();\r\n    } catch {\r\n      setNotify({ open: true, msg: \"Delete failed\", type: \"error\" });\r\n    }\r\n  };\r\n\r\n  const handleSearch = async () => {\r\n    if (!search) return fetchUsers();\r\n    const res = await API.get(`/search?query=${search}`);\r\n    setUsers(res.data);\r\n  };\r\n\r\n  const handleExport = () => {\r\n    window.open(\"http://localhost:5000/api/users/export\", \"_blank\");\r\n  };\r\n\r\n  return (\r\n    <Container>\r\n      <Typography variant=\"h5\" sx={{ mt: 3 }}>\r\n        User Management\r\n      </Typography>\r\n\r\n      <Stack direction={{ xs: \"column\", sm: \"row\" }} spacing={2} sx={{ mt: 2 }}>\r\n        <TextField\r\n          label=\"Search\"\r\n          value={search}\r\n          onChange={(e) => setSearch(e.target.value)}\r\n        />\r\n        <Button variant=\"contained\" onClick={handleSearch}>\r\n          Search\r\n        </Button>\r\n        <Button variant=\"outlined\" onClick={handleExport}>\r\n          Export CSV\r\n        </Button>\r\n        <Button variant=\"contained\" onClick={() => navigate(\"/add\")}>\r\n          Add User\r\n        </Button>\r\n      </Stack>\r\n\r\n      <UserTable users={users} onDelete={handleDelete} />\r\n\r\n      <Pagination\r\n        count={total}\r\n        page={page}\r\n        onChange={(e, val) => setPage(val)}\r\n        sx={{ mt: 3 }}\r\n      />\r\n\r\n      <Notification notify={notify} setNotify={setNotify} />\r\n    </Container>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}